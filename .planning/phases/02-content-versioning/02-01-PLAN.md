---
phase: 02-content-versioning
plan: 01
type: execute
wave: 1
depends_on: ["01-02"]
files_modified:
  - .github/workflows/sync-content.yml
  - src/theme/DocItem/Header/index.tsx
  - docusaurus.config.ts
autonomous: true
requirements: [CONT-01, CONT-02, CONT-04]

must_haves:
  truths:
    - "GitHub Action 'Sync Content from Sandbox' exists and is triggered on dispatch"
    - "Markdown files from sandbox repo are copied into 'docs/' directory"
    - "Docusaurus site builds successfully after content sync"
    - "Swizzled DocItem Header displays status badges based on frontmatter"
  artifacts:
    - path: ".github/workflows/sync-content.yml"
      provides: "Automated content ingestion from private sandbox"
      contains: "repository: johantjader/SIB-normativa-artefakter-sandbox"
    - path: "src/theme/DocItem/Header/index.tsx"
      provides: "UI badges for 'STABLE' and 'DRAFT' statuses"
      contains: "frontMatter.status"
---

<objective>
Establish a content bridge from the private sandbox repository and implement visual lifecycle indicators (badges).

Purpose: Automates the ingestion of normative artifacts and provides clear status context for readers.
Output: A site populated with live content from the sandbox, including status badges.
</objective>

<execution_context>
@C:/Users/jcols/.gemini/get-shit-done/workflows/execute-plan.md
@C:/Users/jcols/.gemini/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-content-versioning/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Content Sync Workflow</name>
  <files>.github/workflows/sync-content.yml</files>
  <action>
    Create the `.github/workflows/sync-content.yml` file.
    Use the configuration from RESEARCH.md:
    - Trigger: `workflow_dispatch` and daily `schedule`.
    - Secrets: Use `secrets.PAT_TOKEN` (the name agreed upon earlier).
    - Logic: Checkout `SIB_pages`, then checkout `SIB-normativa-artefakter-sandbox` into a temp folder, then `rsync` contents (excluding `.git` and `README.md`) into `docs/`.
    - Final step: Commit and push changes back to `SIB_pages`.
  </action>
  <verify>`cat .github/workflows/sync-content.yml` confirms the repository and secret names are correct.</verify>
  <done>The sync workflow is defined and ready for testing.</done>
</task>

<task type="auto">
  <name>Task 2: Swizzle DocItem Header for Badges</name>
  <files>src/theme/DocItem/Header/index.tsx</files>
  <action>
    1. Create the directory: `mkdir -p src/theme/DocItem/Header`
    2. Create `src/theme/DocItem/Header/index.tsx` (using the wrapper pattern from research).
    3. Implement logic to read `status` from frontmatter and render a styled badge (Green for 'stable', Yellow for 'draft').
  </action>
  <verify>Check file content for `const {frontMatter} = useDoc();` and status rendering logic.</verify>
  <done>Custom badge component is integrated into the Docusaurus theme.</done>
</task>

<task type="auto">
  <name>Task 3: Configure Sidebar and Navbar</name>
  <files>docusaurus.config.ts, sidebars.ts</files>
  <action>
    - Update `sidebars.ts` to use `type: 'autogenerated', dirName: '.'` for the tutorial or main documentation sidebar if it isn't already.
    - Rename the navbar item from 'Dokumentation' to 'Artefakter' to better reflect the content.
  </action>
  <verify>`sidebars.ts` uses `autogenerated` and `docusaurus.config.ts` has the updated label.</verify>
  <done>Navigation reflects the incoming artifact structure.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Content sync bridge and lifecycle badges.</what-built>
  <how-to-verify>
    1. Ensure the `PAT_TOKEN` secret is added to the `SIB_pages` repository on GitHub.
    2. Manually trigger the "Sync Content from Sandbox" workflow in the Actions tab.
    3. Verify that new files appear in the `docs/` directory of the `main` branch.
    4. Verify the live site shows the new content and (if status is set in frontmatter) displays the badges.
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues.</resume-signal>
</task>

</tasks>

<verification>
Run `npm run build` locally to ensure the swizzled component doesn't break the build. Confirm the sync workflow logic is sound.
</verification>

<success_criteria>
1. Content is successfully pulled from the private sandbox repository via GitHub Actions.
2. Docusaurus builds and displays the pulled content.
3. Status badges appear correctly for documents with `status` frontmatter.
</success_criteria>

<output>
After completion, create `.planning/phases/02-content-versioning/02-01-SUMMARY.md`
</output>
